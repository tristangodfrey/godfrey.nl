<!DOCTYPE html>
<html lang="{{ site.Language.LanguageCode }}" {{- if eq site.Language.LanguageDirection "rtl" }} dir="rtl" {{- end }}>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{{ if .Site.Params.maintenance_mode }}{{ .Site.Title }}{{ else }}{{ block "title" . }}{{ with .Params.Title }}{{ . }} | {{ end }}{{ .Site.Title }}{{ end }}{{ end }}</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="{{ if .Site.Params.maintenance_mode }}{{ .Site.Params.description }}{{ else }}{{ with .Description }}{{ . }}{{ else }}{{if .IsPage}}{{ .Summary }}{{ else }}{{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}{{ end }}{{ end }}">
    {{ hugo.Generator }}
    {{ $production := hugo.IsProduction }}
    {{ $public := not .Params.private }}
    {{ if and $production $public (not .Site.Params.maintenance_mode) }}
      <meta name="robots" content="index, follow">
    {{ else }}
      <meta name="robots" content="noindex, nofollow">
    {{ end }}

    {{ partials.Include "site-style.html" . }}
    
    {{ if not .Site.Params.maintenance_mode }}
      {{ partials.Include "site-scripts.html" . }}

      {{ block "favicon" . }}
        {{ partials.IncludeCached "site-favicon.html" . }}
      {{ end }}

      {{ if .OutputFormats.Get "RSS" }}
      {{ with .OutputFormats.Get "RSS" }}
        <link href="{{ .RelPermalink }}" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}" />
        <link href="{{ .RelPermalink }}" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }}" />
        {{ end }}
      {{ end }}

      {{ if .Params.canonicalUrl }}
        <link rel="canonical" href="{{ .Params.canonicalUrl }}">
      {{ else }}
        <link rel="canonical" href="{{ .Permalink }}">
      {{ end }}

      {{ partial "opengraph.html" . -}}
      {{ partial "schema.html" . -}}
      {{ partial "twitter_cards.html" . -}}

      {{ if hugo.IsProduction }}
        {{ partial "google_analytics.html" . }}
      {{ end }}
      {{ block "head" . }}{{ partials.Include "head-additions.html" . }}{{ end }}
    {{ end }}
  </head>

  {{- $environment := hugo.Environment | default "production" -}}
  {{- $body_classes := slice "ma0" ($.Param "body_classes" | default "avenir bg-near-white") $environment -}}
  
  {{ if .Site.Params.maintenance_mode }}
    <body class="{{ delimit $body_classes " " }}">
      <header class="bg-white">
        <div class="vh-100 flex flex-column justify-center items-center">
          <div class="tc">
            <h1 class="f2 f-subheadline-l fw2 dark-gray mb0 lh-title avenir">
              {{ if .IsHome }}{{ .Site.Title }}{{ else }}<a href="{{ .Site.Home.RelPermalink }}" class="link dark-gray">{{ .Site.Title }}</a>{{ end }}
            </h1>
            <div class="mt3" style="min-height: 20px;">
              <a href="https://twitter.com/_tristangodfrey?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @_tristangodfrey</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>
          </div>
        </div>
      </header>
    </body>
  {{ else }}
    {{- $body_classes = $body_classes | append (printf "is-%s" .Kind) -}}
    {{- if .IsPage -}}
      {{- $body_classes = $body_classes | append "is-page" -}}
      {{- with .File -}}
        {{- $body_classes = $body_classes | append (printf "page-%s" .ContentBaseName) -}}
      {{- end -}}
    {{- end -}}
    {{- if .IsSection -}}{{- $body_classes = $body_classes | append "is-section" -}}{{- end -}}

    <body class="{{ delimit $body_classes " " }}">
      {{ block "header" . }}{{ partial "site-header.html" . }}{{ end }}
      <main class="pb7" role="main">
        {{ block "main" . }}{{ end }}
      </main>
      {{ block "footer" . }}{{ partials.IncludeCached "site-footer.html" . }}{{ end }}
    </body>
  {{ end }}
</html>
